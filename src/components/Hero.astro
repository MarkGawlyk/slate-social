---
import { ArrowDown } from 'lucide-astro';

// Generate random floating orbs for the animated background
const orbs = Array.from({ length: 6 }, (_, i) => ({
    size: 300 + Math.random() * 400,
    x: Math.random() * 100,
    y: Math.random() * 100,
    delay: i * 2,
    duration: 15 + Math.random() * 10
}));
---

<section class="min-h-screen flex flex-col justify-center items-center relative overflow-hidden">
  <!-- Background - Animated Gradient Mesh -->
  <div class="absolute inset-0 z-0 pointer-events-none select-none">
      <!-- Base gradient -->
      <div class="absolute inset-0 bg-gradient-to-br from-zinc-50 via-white to-zinc-100 dark:from-zinc-950 dark:via-black dark:to-zinc-900"></div>
      
      <!-- Floating gradient orbs -->
      <div class="absolute inset-0 overflow-hidden">
          {orbs.map((orb, i) => (
              <div 
                  class={`absolute rounded-full blur-3xl animate-float-${i % 3}`}
                  style={{
                      width: `${orb.size}px`,
                      height: `${orb.size}px`,
                      left: `${orb.x}%`,
                      top: `${orb.y}%`,
                      background: i % 2 === 0 
                          ? 'radial-gradient(circle, rgba(161, 161, 170, 0.3) 0%, transparent 70%)' 
                          : 'radial-gradient(circle, rgba(113, 113, 122, 0.2) 0%, transparent 70%)',
                      animationDelay: `${orb.delay}s`,
                      animationDuration: `${orb.duration}s`
                  }}
              />
          ))}
      </div>
      
      <!-- Subtle noise texture overlay -->
      <div class="absolute inset-0 opacity-[0.015] dark:opacity-[0.03]" style="background-image: url('data:image/svg+xml,%3Csvg viewBox=%220 0 256 256%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cfilter id=%22noise%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.9%22 numOctaves=%224%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%22100%25%22 height=%22100%25%22 filter=%22url(%23noise)%22/%3E%3C/svg%3E');"></div>
      
      <!-- Radial vignette -->
      <div class="absolute inset-0 bg-[radial-gradient(ellipse_80%_50%_at_50%_50%,_transparent_0%,_rgba(255,255,255,0.8)_100%)] dark:bg-[radial-gradient(ellipse_80%_50%_at_50%_50%,_transparent_0%,_rgba(0,0,0,0.8)_100%)]"></div>
  </div>

  <div class="container px-4 md:px-6 max-w-6xl mx-auto text-center space-y-12 z-10">
    
    <div class="space-y-6">
        <p class="text-xs md:text-sm font-mono uppercase tracking-[0.3em] text-zinc-500 dark:text-zinc-400">
            Social Media for Climbing Gyms
        </p>
        
        <h1 class="text-4xl sm:text-5xl md:text-7xl lg:text-8xl font-black tracking-tighter leading-snug md:leading-[1.1] selection:bg-zinc-900 selection:text-white dark:selection:bg-white dark:selection:text-black">
            The <span class="relative inline-block px-2 md:px-4 before:content-[''] before:absolute before:-inset-0.5 md:before:-inset-1 before:-skew-x-6 before:bg-black before:text-white dark:before:bg-white"><span class="relative text-white dark:text-black z-10">Community Hub</span></span><br /> 
            for your 
            <span class="relative inline-block px-2 md:px-4 before:content-[''] before:absolute before:-inset-0.5 md:before:-inset-1 before:-skew-x-6 before:bg-black before:text-white dark:before:bg-white"><span class="relative text-white dark:text-black z-10">Climbing Gym</span></span>
        </h1>
    </div>

    <div class="h-16 flex items-center justify-center">
        <p class="text-xl md:text-3xl font-mono text-zinc-600 dark:text-zinc-300">
            Slate Social is <span id="glitch-text" class="text-black dark:text-white font-bold border-b-2 border-zinc-900 dark:border-zinc-100 pb-1">loading...</span>
        </p>
    </div>

    <div class="flex flex-col sm:flex-row gap-6 justify-center pt-8">
      <a href="#about" class="group relative min-w-[200px] px-8 py-4 bg-zinc-900 text-white dark:bg-white dark:text-black font-bold overflow-hidden transition-all hover:scale-105 active:scale-95 text-sm uppercase tracking-wider inline-flex items-center justify-center">
        <span class="relative z-10 transition-transform duration-300 group-hover:-translate-x-2">Learn More</span>
        <div class="absolute right-8 opacity-0 translate-x-4 transition-all duration-300 group-hover:opacity-100 group-hover:translate-x-0 z-10">
            <ArrowDown class="w-5 h-5" />
        </div>
        <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
      </a>
    </div>
  </div>
</section>

<script>
    const phrases = [
        "a message board",
        "community groups",
        "gym competitions",
        "club management",
        "member polls",
        "beta sharing",
        "partner finding",
        "your community hub"
    ];
    
    const el = document.getElementById('glitch-text');
    const chars = '!<>-_\\/[]{}â€”=+*^?#________';
    
    let counter = 0;
    
    const nextPhrase = () => {
        counter = (counter + 1) % phrases.length;
        return phrases[counter];
    };
    
    const scramble = async (element: HTMLElement, newText: string) => {
        const oldText = element.innerText;
        const length = Math.max(oldText.length, newText.length);
        const promise = new Promise<void>((resolve) => {
            let frame = 0;
            const queue: { from: string, to: string, start: number, end: number }[] = [];
            
            for (let i = 0; i < length; i++) {
                const from = oldText[i] || '';
                const to = newText[i] || '';
                const start = Math.floor(Math.random() * 15);
                const end = start + Math.floor(Math.random() * 15);
                queue.push({ from, to, start, end });
            }
            
            const update = () => {
               let output = '';
               let complete = 0;
               
               for (let i = 0; i < length; i++) {
                   const { from, to, start, end } = queue[i];
                   let char = from;
                   
                   if (frame >= end) {
                       char = to;
                       complete++;
                   } else if (frame >= start) {
                       char = chars[Math.floor(Math.random() * chars.length)];
                   }
                   
                   output += char;
               }
               
               element.innerText = output;
               
               if (complete === length) {
                   resolve();
               } else {
                   frame++;
                   requestAnimationFrame(update);
               }
            };
            
            update();
        });
        return promise;
    };
    
    const loop = async () => {
        while(true) {
            await new Promise(r => setTimeout(r, 3000)); // Wait before changing
            if (el) {
                await scramble(el, nextPhrase());
            }
        }
    };
    
    // Start loop
    if (el) {
        el.innerText = phrases[0];
        loop();
    }
</script>

<style>
    @keyframes float-0 {
        0%, 100% { transform: translate(0, 0) scale(1); }
        25% { transform: translate(30px, -50px) scale(1.1); }
        50% { transform: translate(-20px, -100px) scale(0.9); }
        75% { transform: translate(-40px, -30px) scale(1.05); }
    }
    @keyframes float-1 {
        0%, 100% { transform: translate(0, 0) scale(1); }
        25% { transform: translate(-50px, 30px) scale(0.95); }
        50% { transform: translate(40px, 60px) scale(1.1); }
        75% { transform: translate(20px, -40px) scale(1); }
    }
    @keyframes float-2 {
        0%, 100% { transform: translate(0, 0) scale(1); }
        25% { transform: translate(60px, 40px) scale(1.05); }
        50% { transform: translate(-30px, -30px) scale(0.9); }
        75% { transform: translate(-60px, 50px) scale(1.1); }
    }
    .animate-float-0 {
        animation: float-0 ease-in-out infinite;
    }
    .animate-float-1 {
        animation: float-1 ease-in-out infinite;
    }
    .animate-float-2 {
        animation: float-2 ease-in-out infinite;
    }
</style>
