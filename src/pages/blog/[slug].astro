---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: { post },
	}));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={`${post.data.title} | Slate Social Blog`} description={post.data.description}>
	<header class="site-header container">
		<a class="logo" href="/">Slate Social</a>
		<a class="pill" href="/blog">All posts</a>
	</header>

	<main>
		<section class="container article">
			<p class="eyebrow">Slate Social Blog</p>
			<h1>{post.data.title}</h1>
			<div class="meta">
				<Image src={post.data.authorImage} alt={post.data.author} class="avatar" widths={[64]} />
				<div>
					<p class="author">{post.data.author}</p>
					<time datetime={post.data.pubDate.toISOString()}>
						{post.data.pubDate.toLocaleDateString(undefined, {
							month: 'short',
							day: 'numeric',
							year: 'numeric',
						})}
					</time>
				</div>
			</div>
			<Image src={post.data.heroImage} alt={post.data.title} class="hero" widths={[720, 1080]} loading="lazy" />
			<div class="content">
				<Content />
			</div>
			<a class="back" href="/blog">‚Üê Back to all posts</a>
		</section>
	</main>

	<style>
		.site-header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 1.5rem 0 0;
		}

		.logo {
			font-weight: 800;
			font-size: 1.05rem;
			letter-spacing: -0.03em;
		}

		.pill {
			padding: 0.75rem 1rem;
			border: 1px solid var(--border);
			border-radius: var(--radius-sm);
			font-weight: 600;
		}

		.article {
			max-width: 820px;
		}

		.eyebrow {
			text-transform: uppercase;
			letter-spacing: 0.15em;
			font-weight: 700;
			color: var(--muted);
			font-size: 0.8rem;
			margin-bottom: 0.5rem;
		}

		h1 {
			font-size: clamp(2rem, 4vw, 3rem);
			margin: 0 0 1rem;
			line-height: 1.1;
		}

		.meta {
			display: flex;
			gap: 0.75rem;
			align-items: center;
			color: var(--muted);
		}

		.avatar {
			width: 48px;
			height: 48px;
			border-radius: 50%;
			border: 1px solid var(--border);
		}

		.author {
			margin: 0;
			font-weight: 600;
			color: var(--text);
		}

		time {
			color: var(--muted);
			font-size: 0.95rem;
		}

		.hero {
			width: 100%;
			height: auto;
			border-radius: var(--radius-lg);
			margin: 1.5rem 0;
			border: 1px solid var(--border);
			box-shadow: var(--shadow);
		}

		.content {
			color: var(--text);
			font-size: 1.05rem;
			line-height: 1.7;
			display: grid;
			gap: 1.25rem;
		}

		.content h2 {
			margin: 1.25rem 0 0.5rem;
			font-size: 1.35rem;
			letter-spacing: -0.01em;
		}

		.content p {
			margin: 0;
			color: #1f2937;
		}

		.back {
			display: inline-flex;
			align-items: center;
			margin-top: 2rem;
			font-weight: 600;
			color: var(--text);
		}

		.back:hover {
			text-decoration: underline;
		}
	</style>
</BaseLayout>
